(function(t){function e(e){for(var i,r,o=e[0],c=e[1],l=e[2],u=0,f=[];u<o.length;u++)r=o[u],Object.prototype.hasOwnProperty.call(n,r)&&n[r]&&f.push(n[r][0]),n[r]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(t[i]=c[i]);v&&v(e);while(f.length)f.shift()();return a.push.apply(a,l||[]),s()}function s(){for(var t,e=0;e<a.length;e++){for(var s=a[e],i=!0,o=1;o<s.length;o++){var c=s[o];0!==n[c]&&(i=!1)}i&&(a.splice(e--,1),t=r(r.s=s[0]))}return t}var i={},n={app:0},a=[];function r(e){if(i[e])return i[e].exports;var s=i[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.m=t,r.c=i,r.d=function(t,e,s){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(s,i,function(e){return t[e]}.bind(null,i));return s},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/gui/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=e,o=o.slice();for(var l=0;l<o.length;l++)e(o[l]);var v=c;a.push([0,"chunk-vendors"]),s()})({0:function(t,e,s){t.exports=s("56d7")},"034f":function(t,e,s){"use strict";var i=s("8a23"),n=s.n(i);n.a},"30fe":function(t,e,s){},4310:function(t,e,s){},"4e5b":function(t,e,s){"use strict";var i=s("30fe"),n=s.n(i);n.a},"56d7":function(t,e,s){"use strict";s.r(e);s("e260"),s("e6cf"),s("cca6"),s("a79d");var i=s("a026"),n=(s("54ba"),function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-app",{attrs:{id:"inspire"}},[s("BrokerSub"),s("v-navigation-drawer",{attrs:{app:""},model:{value:t.drawer,callback:function(e){t.drawer=e},expression:"drawer"}},[s("v-list",{attrs:{dense:""}},[s("router-link",{attrs:{to:"/"}},[s("v-list-item",{attrs:{link:""}},[s("v-list-item-action",[s("v-icon",[t._v("mdi-grid")])],1),s("v-list-item-content",[s("v-list-item-title",[t._v("Switchboard")])],1)],1)],1),s("router-link",{attrs:{to:"/status"}},[s("v-list-item",{attrs:{link:""}},[s("v-list-item-action",[s("v-icon",[t._v("mdi-home-analytics")])],1),s("v-list-item-content",[s("v-list-item-title",[t._v("Status")])],1)],1)],1)],1)],1),s("v-app-bar",{attrs:{app:"",color:"indigo",dark:""}},[s("v-app-bar-nav-icon",{on:{click:function(e){e.stopPropagation(),t.drawer=!t.drawer}}}),s("v-toolbar-title",[t._v("MSE GUI "),"/"==t.$route.path?s("span",[t._v("- Switchboard")]):t._e(),"/status"==t.$route.path?s("span",[t._v("- Status")]):t._e()])],1),s("v-main",[s("router-view")],1),s("v-footer",{attrs:{color:"indigo",app:""}},[s("span",{staticClass:"white--text"},[t._v("Â© "+t._s((new Date).getFullYear()))])])],1)}),a=[],r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span")},o=[],c=(s("caad"),s("fb6a"),s("ac1f"),s("2532"),s("5319"),s("1276"),{name:"BrokerSub",mounted:function(){this.$mqtt.subscribe("$SYS/broker/version"),this.$mqtt.subscribe("codac/das/diag/msx/config/command"),this.$mqtt.subscribe("codac/das/diag/msx/cstate/board/#"),this.$mqtt.subscribe("codac/das/diag/msx/cstate/ovens/#"),this.$mqtt.subscribe("codac/das/diag/+/state"),this.$mqtt.subscribe("codac/das/diag/msx/config/ovens/#"),this.$mqtt.subscribe("codac/das/diag/msx/cstate/volts/#"),this.$mqtt.subscribe("codac/das/diag/msx/config/volts/+/+/detector");var t=this;this.$mqtt._events.close.push((function(){console.log("disconnected to broker"),t.$store.dispatch("setConnected",!1)}))},mqtt:{"$SYS/broker/version":function(){var t=this;setTimeout((function(){console.log("connected to broker --"),t.$store.dispatch("setConnected",!0)}),500)},"codac/das/diag/msx/cstate/board/#":function(t,e){var s=e.split("/"),i=s[s.length-2],n=s[s.length-1];i=parseInt(i.slice(3,5))-1,n=parseInt(n.slice(3,5))-1;var a=JSON.parse(String(t)).value;this.$store.dispatch("setfiberName",{x:i,y:n,value:a});var r="";r=a.includes("PMT")?"PMT":a.includes("PY")?"PY":"n/a",this.$store.dispatch("setfiberType",{x:i,y:n,value:r})},"codac/das/diag/msx/cstate/volts/#":function(t,e){var s=e.split("/"),i=s[s.length-2],n=s[s.length-1],a=i+":"+n[n.length-1],r=JSON.parse(String(t)).value;this.$store.dispatch("setFeedValue",{index:a,value:r})},"codac/das/diag/msx/cstate/ovens/#":function(t,e){var s=e.split("/"),i=s[s.length-1],n=s[s.length-2];n.includes("PY")&&(n=n.replace("Pi","PI"),n=n.replace("Bg1","BG1"),n=n.replace("Sigma","SIGMA"),n=n.replace("Bg2","BG2"));var a=JSON.parse(String(t)).value,r="";switch(i){case"tcrn":r="setOvenTcrn";break;case"heat_on":r="setOvenHeat_on";break;default:return}this.$store.dispatch(r,{fiberType:n,value:a})},"codac/das/diag/msx/config/ovens/#":function(t,e){var s=e.split("/"),i=s[s.length-1],n=s[s.length-2],a=JSON.parse(String(t)).value,r="";switch(i){case"tset":r="setOvenTset";break;case"active":r="setOvenState";break;case"wltarget":r="setWLTarget";break;case"m":r="setOvenFitM",n=s[s.length-3];break;case"c":r="setOvenFitC",n=s[s.length-3];break;default:return}(n.includes("PMT")||n.includes("PY"))&&(console.log("from broker sub:",n,a),this.$store.dispatch(r,{oven:n,value:a}))},"codac/das/diag/msx/config/volts/+/+/detector":function(t,e){var s=e.split("/"),i=s[s.length-3],n=s[s.length-2],a=i+":"+n[n.length-1],r=JSON.parse(String(t)).value;this.$store.dispatch("setDetectorHVPair",{hvsource:a,detector:r})},"codac/das/diag/+/cstate":function(t,e){var s=e.split("/"),i=JSON.parse(String(t)).value,n="";"msx"==s[s.length-2]?(n="msxrunning",this.$store.dispatch("setStatus",{diagnostic:n,value:i})):"msr"==s[s.length-2]?(n="msrrunning",this.$store.dispatch("setStatus",{diagnostic:n,value:i})):"mss"==s[s.length-2]&&(n="mssrunning",this.$store.dispatch("setStatus",{diagnostic:n,value:i}))},"codac/das/diag/msx/config/command":function(t){var e=JSON.parse(String(t)).value;this.$store.dispatch("setCommand",e)}}}),l=c,v=s("2877"),u=Object(v["a"])(l,r,o,!1,null,null,null),f=u.exports,d={props:{source:String},data:function(){return{drawer:null}},components:{BrokerSub:f}},m=d,h=(s("034f"),s("6544")),b=s.n(h),p=s("7496"),g=s("40dc"),_=s("5bc1"),T=s("553a"),x=s("132d"),y=s("8860"),C=s("da13"),w=s("1800"),V=s("5d23"),P=s("f6c4"),k=s("f774"),S=s("2a7f"),N=Object(v["a"])(m,n,a,!1,null,null,null),$=N.exports;b()(N,{VApp:p["a"],VAppBar:g["a"],VAppBarNavIcon:_["a"],VFooter:T["a"],VIcon:x["a"],VList:y["a"],VListItem:C["a"],VListItemAction:w["a"],VListItemContent:V["a"],VListItemTitle:V["b"],VMain:P["a"],VNavigationDrawer:k["a"],VToolbarTitle:S["a"]});var O=s("daa7"),M=s.n(O),E=s("8c4f"),I=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t.connecting?t._e():s("Commands"),t.connecting?t._e():s("v-container",{staticClass:"grey",attrs:{"no-gutters":"",fluid:""}},t._l(6,(function(e){return s("v-row",{key:e,staticClass:"justify-space-between",attrs:{"no-gutters":""}},t._l(10,(function(t){return s("v-col",{key:t,attrs:{cols:1}},[s("SwitchboardPosition",{attrs:{pos:{x:10-t,y:e-1}}})],1)})),1)})),1),s("v-dialog",{attrs:{"hide-overlay":"",persistent:"",width:"300"},model:{value:t.connecting,callback:function(e){t.connecting=e},expression:"connecting"}},[s("v-card",{attrs:{color:"primary",dark:""}},[s("v-card-text",[t._v(" Attempting to connect to broker "),s("v-progress-linear",{staticClass:"mb-0",attrs:{indeterminate:"",color:"white"}})],1)],1)],1)],1)},F=[],Y=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("v-card",{class:{"indigo darken-1":"PY"==t.boardPos.fiberType,"white--text":"PY"==t.boardPos.fiberType||"PMT"==t.boardPos.fiberType,"grey lighten-1":"n/a"==t.boardPos.fiberType,"grey--text text--darken-1":"n/a"==t.boardPos.fiberType,"teal darken-1":"PMT"==t.boardPos.fiberType},on:{click:t.openDialog}},[s("div",[s("p",{class:{"smallest-screen":t.$vuetify.breakpoint.width<350,"small-screen":t.$vuetify.breakpoint.width<600}},[t._v(" "+t._s(t.pos.x+1)+"-"+t._s(t.pos.y+1)+" "),s("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,n=e.attrs;return[s("v-icon",t._g(t._b({class:t.status.colorClass},"v-icon",n,!1),i),[t._v(" "+t._s(t.status.icon)+" ")])]}}])},[s("span",[t._v(t._s(t.status.tooltip))])])],1),t.$vuetify.breakpoint.width>=610?s("p",{class:{"smallest-screen":t.$vuetify.breakpoint.width<700,"med-screen":t.$vuetify.breakpoint.width<890}},[t._v(t._s(t.boardPos.fiberName))]):t._e(),t.$vuetify.breakpoint.width<610?s("p",{staticClass:"small-screen"},[t._v(" "+t._s(t.boardPos.fiberType))]):t._e()]),s("v-dialog",{attrs:{"max-width":"700px"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[s("v-card",[s("EditMenu",{ref:"EditMenu",attrs:{pos:t.pos,isEditing:t.isEditing}}),s("v-card-actions",[s("v-spacer"),s("v-btn",{attrs:{color:"indigo darken-1",text:""},on:{click:t.closeDialog}},[t._v("Close")]),s("v-btn",{attrs:{disabled:!t.isEditing,color:"success"},on:{click:t.saveDialog}},[t._v(" Save ")]),s("v-btn",{staticClass:"white--text",attrs:{color:"indigo darken-1",fab:"",small:""},on:{click:function(e){t.isEditing=!t.isEditing}}},[t.isEditing?s("v-icon",[t._v("mdi-close")]):s("v-icon",[t._v("mdi-pencil")])],1)],1)],1)],1)],1)],1)},H=[],D=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("v-tabs",{attrs:{centered:"","background-color":"indigo",dark:"","icons-and-text":""},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[s("v-tabs-slider"),s("v-tab",{attrs:{href:"#tab-1"}},[t._v(" Name "),s("v-icon",[t._v("mdi-panorama-wide-angle")])],1),s("v-tab",{attrs:{href:"#tab-2"}},[t._v(" Voltage Sources "),s("v-icon",[t._v("mdi-washing-machine")])],1),s("v-tab",{attrs:{href:"#tab-3"}},[t._v(" Ovens "),s("v-icon",[t._v("mdi-fireplace")])],1)],1),s("v-tabs-items",{model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[s("v-alert",{attrs:{"close-text":"Close Alert",type:"error",dismissible:""},model:{value:t.alert,callback:function(e){t.alert=e},expression:"alert"}},[t._v(" "+t._s(t.status.alertText)+" ")]),s("v-tab-item",{attrs:{value:"tab-1"}},[s("v-card",{attrs:{flat:""}},[s("v-container",[s("v-row",[s("v-radio-group",{attrs:{disabled:!t.isEditing,row:""},model:{value:t.form.fiberType,callback:function(e){t.$set(t.form,"fiberType",e)},expression:"form.fiberType"}},[s("v-radio",{attrs:{label:"Disconnected",value:"n/a"}}),s("v-radio",{attrs:{label:"Photomultiplier Tube",value:"PMT"}}),s("v-radio",{attrs:{label:"Polychromator",value:"PY"}})],1)],1),"n/a"!==t.form.fiberType?s("v-row",[s("v-col",{attrs:{cols:"12"}},[s("v-select",{attrs:{items:t.choosefiberType,disabled:!t.isEditing,"append-outer-icon":"mdi-video-input-hdmi","menu-props":"auto","hide-details":"",label:"Name","single-line":""},model:{value:t.form.fiberName,callback:function(e){t.$set(t.form,"fiberName",e)},expression:"form.fiberName"}})],1)],1):t._e()],1)],1)],1),s("v-tab-item",{attrs:{value:"tab-2"}},[s("v-card",{attrs:{flat:""}},[s("v-container",["n/a"==t.form.fiberType?s("span",[s("v-card-title",[t._v("There is no fiberType connected to this position")])],1):s("span",[s("v-row",[s("v-col",[s("v-card-text",[s("span",{staticClass:"mb-4"},[t._v("FIBER: "+t._s(t.form.fiberName))])])],1)],1),t._l(t.form.hvsources,(function(e,i){return s("v-row",{key:i},[s("v-col",{attrs:{cols:"2"}},[s("v-card-subtitle",[t._v(t._s(i))])],1),s("v-col",{attrs:{cols:"3"}},[s("v-card-text",[t._v(" Volts: "),t.feed[e.hvlabel]?s("span",[t._v(t._s(t.feed[e.hvlabel].value)+" V")]):t._e()])],1),s("v-col",{attrs:{cols:"3"}},[s("v-select",{attrs:{disabled:!t.isEditing,items:t.HVNames,"append-outer-icon":"mdi-video-input-hdmi","hide-details":"",label:"HV label","single-line":""},model:{value:t.form.hvsources[i].hvlabel,callback:function(e){t.$set(t.form.hvsources[i],"hvlabel",e)},expression:"form.hvsources[name].hvlabel"}})],1),s("v-col",{attrs:{cols:"4"}},[s("v-text-field",{attrs:{label:"Set voltage",type:"number",disabled:!t.isEditing},model:{value:t.form.hvsources[i].voltset,callback:function(e){t.$set(t.form.hvsources[i],"voltset",e)},expression:"form.hvsources[name].voltset"}})],1)],1)}))],2)])],1)],1),s("v-tab-item",{attrs:{value:"tab-3"}},[s("v-card",{attrs:{flat:""}},[t.status.oven.ovenConnected?t._e():s("span",[s("v-card-title",[t._v("There is no oven connected to this fiberType")])],1),"n/a"==t.form.fiberType&&t.ovens[t.form.fiberName]?s("span",[s("v-card-title",[t._v("There is no fiberType connected to this position")])],1):t._e(),"PMT"!=t.form.fiberType&&"PY"!=t.form.fiberType||!t.status.oven.ovenConnected?t._e():s("span",[s("v-list-item",[s("v-card-text",[s("span",{staticClass:"mb-4"},[t._v("FIBER: "+t._s(t.form.fiberName))])]),s("v-select",{attrs:{items:t.filterNames,filled:"",dense:""},model:{value:t.filter,callback:function(e){t.filter=e},expression:"filter"}})],1),s("v-list-item",[s("v-list-item-icon",[s("v-icon",{class:t.status.oven.stateColorClass},[t._v(" "+t._s(t.status.oven.stateIcon)+" ")])],1),t._v(" "+t._s(t.status.oven.text)+" "),s("v-switch",{staticClass:"ml-2",attrs:{inset:"",disabled:!t.isEditing},model:{value:t.form.ovens[t.filter].setactive,callback:function(e){t.$set(t.form.ovens[t.filter],"setactive",e)},expression:"form.ovens[filter].setactive"}})],1),s("v-list-item",[s("v-list-item-icon",[s("v-icon",[t._v(" mdi-thermometer ")])],1),s("v-list-item-title",[t._v(" Current Temp: "+t._s(t.status.oven.tcrn)+" "),s("v-icon",[t._v("mdi-temperature-celsius")])],1)],1),s("v-list-item",[s("v-list-item-icon",[s("v-icon",[t._v("mdi-thermometer-alert")])],1),s("v-list-item-title",[s("v-text-field",{attrs:{label:"Set Temp",type:"number",disabled:!t.isEditing,required:""},model:{value:t.form.ovens[t.filter].tset,callback:function(e){t.$set(t.form.ovens[t.filter],"tset",e)},expression:"form.ovens[filter].tset"}})],1)],1),s("v-list-item",[s("v-list-item-icon",[s("v-icon",[t._v("mdi-sine-wave")])],1),s("v-list-item-title",[t._v("Target Wavelength (From Torus): "+t._s(t.status.oven.wltarget)+" nm")])],1),s("v-list-item",[s("v-list-item-icon",[s("v-icon",[t._v("mdi-sine-wave")])],1),s("v-list-item-title",[t._v("Current Filter Wavelength: "+t._s(t.status.oven.wlcrn)+" nm")])],1),s("v-list-item",[s("v-list-item-icon",[s("v-icon",[t._v("mdi-sine-wave")])],1),s("v-list-item-title",[s("v-text-field",{attrs:{label:"Set Filter Wavelength",type:"number",disabled:!t.isEditing,required:""},model:{value:t.wavelength,callback:function(e){t.wavelength=e},expression:"wavelength"}})],1)],1)],1)])],1)],1)],1)},R=[],A=(s("4de4"),s("4160"),{name:"EditMenu",data:function(){return{form:{fiberType:"",fiberName:"",hvsources:{},ovens:{}},filter:"",tab:null,alert:!1,PMTNames:["PMT_01","PMT_02","PMT_03","PMT_04","PMT_05","PMT_06","PMT_07","PMT_08","PMT_09","PMT_10"],PYNames:["PY_01_01","PY_01_02","PY_01_03","PY_01_04","PY_02_01","PY_02_02","PY_02_03","PY_02_04","PY_03_01","PY_03_02","PY_03_03","PY_03_04","PY_04_01","PY_04_02","PY_04_03","PY_04_04"],HVNames:["HV_1_2:0","HV_1_2:1","HV_3_4:0","HV_3_4:1","HV_5_6:0","HV_5_6:1","HV_7_8:0","HV_7_8:1","HV_9_10:0","HV_9_10:1","HV_11_12:0","HV_11_12:1","HV_13_14:0","HV_13_14:1","HV_15_16:0","HV_15_16:1","HV_17_18:0","HV_17_18:1","HV_19_20:0","HV_19_20:1"],filterNames:[]}},mounted:function(){this.setForm()},props:["pos","isEditing"],methods:{checkForm:function(t){if("PMT"==t.fiberType&&!t.fiberName.includes("PMT"))return this.status.alertText="User must select a fiber name",!1;if("PY"==t.fiberType&&!t.fiberName.includes("PY"))return this.status.alertText="User must select a fiber name",!1;if("PY"==t.fiberType)for(var e=["PI","BG1","SIGMA","BG2"],s=0;s<4;s++)for(var i=e[s],n=s+1;n<4;n++){var a=e[n];if(this.form.hvsources[i].hvlabel==this.form.hvsources[a].hvlabel&&""!=this.form.hvsources[i].hvlabel)return this.status.alertText="Multiple detectors have the same HV source selected",!1}return!0},submitForm:function(){return this.checkForm(this.form)?(this.alert=!1,this.publishFiberName(),this.publishVoltages(),this.publishOven(),!0):(this.alert=!0,!1)},setForm:function(){var t=this.$store.getters.getBoardPosition({x:this.pos.x,y:this.pos.y});this.$set(this.form,"fiberType",t.fiberType),this.$set(this.form,"fiberName",t.fiberName),this.refreshFilters(this.form.fiberType),this.refreshVoltageSources(this.form.fiberType)},refreshVoltageSources:function(t){if("PMT"==t){var e={hvlabel:this.ovens[this.form.fiberName]?this.ovens[this.form.fiberName].hvsource:"",voltset:"",setsfh:!1};return this.form.hvsources={},void(this.form.hvsources["DETECTOR"]=e)}if("PY"==t){this.form.hvsources={};var s=this.polyFiberToPolyName(this.form.fiberName);s+="_";var i=["PI","BG1","SIGMA","BG2"],n=this;i.forEach((function(t){n.form.hvsources[t]={hvlabel:n.ovens[s+t]?n.ovens[s+t].hvsource:"",voltset:"",setsfh:!1}}))}},refreshFilters:function(t){if("PMT"==t){this.filterNames=["FILTER"],this.filter="FILTER",this.form.ovens={};var e="",s=!1,i=0,n=0;this.ovens[this.form.fiberName]&&(e=this.ovens[this.form.fiberName].tset,s=this.ovens[this.form.fiberName].state,i=this.ovens[this.form.fiberName].fitM,n=this.ovens[this.form.fiberName].fitC),this.$set(this.form.ovens,"FILTER",{}),this.$set(this.form.ovens["FILTER"],"tset",e),this.$set(this.form.ovens["FILTER"],"setactive",s),this.$set(this.form.ovens["FILTER"],"fitM",i),this.$set(this.form.ovens["FILTER"],"fitC",n)}if("PY"==t){this.filterNames=["PI","SIGMA"],this.filter="PI",this.form.ovens={};var a=["PI","SIGMA"],r=this;a.forEach((function(t){var e="",s=0,i=0,n=0,a=r.form.fiberName.split("_")[0]+"_"+r.form.fiberName.split("_")[1]+"_",o=a+t;r.ovens[o]&&(e=r.ovens[o].tset,s=r.ovens[o].state,i=r.ovens[o].fitM,n=r.ovens[o].fitC),r.$set(r.form.ovens,t,{}),r.$set(r.form.ovens[t],"tset",e),r.$set(r.form.ovens[t],"setactive",s),r.$set(r.form.ovens[t],"fitM",i),r.$set(r.form.ovens[t],"fitC",n)}))}},publishFiberName:function(){var t,e,s,i=this.pos.x+1,n=this.pos.y+1;i=("0"+i).slice(-2),n=("0"+n).slice(-2),t="codac/das/diag/msx/cstate/board/col"+i+"/row"+n,e=(new Date).getTime();var a=this.form.fiberName;"n/a"==this.form.fiberType&&(a="n/a"),s={value:a,time:e},this.$mqtt.publish(t,JSON.stringify(s),{retain:!0})},publishVoltages:function(){var t,e,s;if("PMT"==this.form.fiberType||"PY"==this.form.fiberType)for(var i in this.form.hvsources){var n=this.form.hvsources[i].hvlabel;if(n){var a=n.slice(0,n.length-2),r=n.slice(n.length-1);t="codac/das/diag/msx/config/volts/"+a+"/feed_"+r+"/detector",e=(new Date).getTime();var o=void 0;if("PY"==this.form.fiberType){var c=this.form.fiberName.split("_")[0]+"_"+this.form.fiberName.split("_")[1]+"_";o=c+i}else o=this.form.fiberName;if(s={value:o,time:e},this.$mqtt.publish(t,JSON.stringify(s),{retain:!0}),this.form.hvsources[i].voltset){t="codac/das/diag/msx/config/volts/"+a+"/feed_"+r+"/voltset";var l=this.form.hvsources[i].voltset;s={value:l,time:e},this.$mqtt.publish(t,JSON.stringify(s),{retain:!0})}}}},publishOven:function(){var t,e,s,i=this.status.oven.ovenConnected&&(this.form.fiberName.includes("PY")||this.form.fiberName.includes("PMT"));if(i)for(var n in this.form.ovens)if(this.form.ovens[n].tset){var a="";if("PY"==this.form.fiberType){var r=this.form.fiberName.split("_")[0]+"_"+this.form.fiberName.split("_")[1]+"_";a=r+n}else a=this.form.fiberName;t="codac/das/diag/msx/config/ovens/"+a+"/tset",e=(new Date).getTime();var o=this.form.ovens[n].tset;s={value:o,time:e},this.$mqtt.publish(t,JSON.stringify(s),{retain:!0}),t="codac/das/diag/msx/config/ovens/"+a+"/active",o=this.form.ovens[n].setactive?1:0,s={value:o,time:e},this.$mqtt.publish(t,JSON.stringify(s),{retain:!0})}},polyFiberToPolyName:function(t){return t.includes("PY")?t.split("_")[0]+"_"+t.split("_")[1]:t},tempToWl:function(t){if(t&&this.form.ovens[this.filter]){var e=this.form.ovens[this.filter].fitM,s=this.form.ovens[this.filter].fitC;return t=parseFloat(t),e*t+s}return null},wlToTemp:function(t){if(t&&this.form.ovens[this.filter]){var e=this.form.ovens[this.filter].fitM,s=this.form.ovens[this.filter].fitC;return t=parseFloat(t),0==e?null:(t-s)/e}return null}},watch:{"form.fiberName":function(){this.refreshVoltageSources(this.form.fiberType),this.refreshFilters(this.form.fiberType)},"form.fiberType":function(t){this.refreshVoltageSources(t),this.refreshFilters(t)}},computed:{feed:function(){return this.$store.getters.feed},ovens:function(){return this.$store.getters.ovens},wavelength:{get:function(){return this.tempToWl(this.form.ovens[this.filter].tset)},set:function(t){this.form.ovens[this.filter].tset=this.wlToTemp(t)}},choosefiberType:function(){return"PMT"==this.form.fiberType?this.PMTNames:"PY"==this.form.fiberType?this.PYNames:0},status:function(){var t={alertText:"",oven:{ovenConnected:!0,stateIcon:"",stateColorClass:"",text:"",tcrn:"",tset:"",wltarget:"",wlcrn:""},HVfeed:{PMTvolts:1,PYpivolts:2,PYbg1volts:3,PYsigmavolts:4,PYbg2volts:5}},e="";if("PMT"==this.form.fiberType)e=this.form.fiberName;else if("PY"==this.form.fiberType){var s=this.form.fiberName.split("_")[0]+"_"+this.form.fiberName.split("_")[1]+"_";e=s+this.filter}return this.ovens[e]&&(this.$set(t.oven,"state",this.ovens[e].state),this.$set(t.oven,"tcrn",this.ovens[e].tcrn),this.$set(t.oven,"wltarget",this.ovens[e].wltarget),this.$set(t.oven,"wlcrn",this.tempToWl(t.oven.tcrn)),this.form.ovens[this.filter].setactive?(this.$set(t.oven,"stateIcon","mdi-check-circle"),this.$set(t.oven,"stateColorClass","green--text"),this.$set(t.oven,"text","Active")):this.form.ovens[this.filter].setactive||(this.$set(t.oven,"stateIcon","mdi-close-circle"),this.$set(t.oven,"stateColorClass","red--text"),this.$set(t.oven,"text","Inactive"))),t}}}),B=A,L=s("0798"),j=s("b0af"),q=s("99d9"),G=s("62ad"),J=s("a523"),W=s("34c3"),U=s("67b6"),K=s("43a6"),X=s("0fd9"),z=s("b974"),Q=s("b73d"),Z=s("71a3"),tt=s("c671"),et=s("fe57"),st=s("aac8"),it=s("9a96"),nt=s("8654"),at=Object(v["a"])(B,D,R,!1,null,null,null),rt=at.exports;b()(at,{VAlert:L["a"],VCard:j["a"],VCardSubtitle:q["b"],VCardText:q["c"],VCardTitle:q["d"],VCol:G["a"],VContainer:J["a"],VIcon:x["a"],VListItem:C["a"],VListItemIcon:W["a"],VListItemTitle:V["b"],VRadio:U["a"],VRadioGroup:K["a"],VRow:X["a"],VSelect:z["a"],VSwitch:Q["a"],VTab:Z["a"],VTabItem:tt["a"],VTabs:et["a"],VTabsItems:st["a"],VTabsSlider:it["a"],VTextField:nt["a"]});var ot={name:"SwitchboardPosition",components:{EditMenu:rt},props:{pos:Object},data:function(){return{isEditing:!1,dialog:!1}},methods:{saveDialog:function(){this.$refs.EditMenu.submitForm()&&(this.isEditing=!1)},openDialog:function(){this.dialog=!0,this.$refs.EditMenu&&this.$refs.EditMenu.setForm()},closeDialog:function(){this.dialog=!1,this.isEditing=!1,this.$refs.EditMenu.alert=!1}},computed:{boardPos:function(){return this.$store.getters.getBoardPosition({x:this.pos.x,y:this.pos.y})},status:function(){var t={icon:"mdi-check-circle",colorClass:"light-green--text",tooltip:"Configured correctly"};return"n/a"==this.boardPos.fiberName&&(t={icon:"mdi-block-helper",colorClass:"grey--text",tooltip:"Not connected"}),t}}},ct=ot,lt=(s("c3d2"),s("8336")),vt=s("169a"),ut=s("2fa4"),ft=s("3a2f"),dt=Object(v["a"])(ct,Y,H,!1,null,null,null),mt=dt.exports;b()(dt,{VBtn:lt["a"],VCard:j["a"],VCardActions:q["a"],VDialog:vt["a"],VIcon:x["a"],VSpacer:ut["a"],VTooltip:ft["a"]});var ht=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"openCommand"}},[s("v-btn",{staticClass:"white--text",attrs:{color:"indigo darken-1"},on:{click:function(e){t.dialog=!0}}},[t._v(" Send Command ")]),s("v-dialog",{attrs:{"max-width":"700px"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[s("v-card",[s("v-tabs",{attrs:{"fixed-tabs":"","background-color":"indigo","icons-and-text":"",disabled:"true",dark:""}},[s("v-tab",[t._v(" Send Commands To Back End "),s("v-icon",[t._v("mdi-console")])],1)],1),s("v-alert",{attrs:{type:t.alertType}},[t._v(" response: "+t._s(t.response)+" ")]),s("v-container",{staticClass:"justify-center"},[s("v-row",{staticClass:"cmdRow",attrs:{dense:""}},[s("v-col",{attrs:{cols:"4"}},[s("v-btn",{staticClass:"white--text",attrs:{color:"indigo darken-1"},on:{click:function(e){return t.sendCmd("hvoff")}}},[t._v(" hvoff ")])],1),s("v-col",{attrs:{cols:"4"}},[s("v-text-field",{staticClass:"d-inline",attrs:{label:"Call shot or voltage",type:"number"},model:{value:t.wlNum,callback:function(e){t.wlNum=e},expression:"wlNum"}})],1),s("v-col",{attrs:{cols:"4"}},[s("v-btn",{staticClass:"d-inline white--text",attrs:{color:"indigo darken-1"},on:{click:function(e){return t.sendCmd("wavelength-"+t.wlNum)}}},[t._v(" wavelength-"+t._s(t.wlNum)+" ")])],1)],1),s("v-row",{staticClass:"cmdRow",attrs:{dense:""}},[s("v-col",{attrs:{cols:"3"}},[s("v-btn",{staticClass:"white--text",attrs:{color:"indigo darken-1"},on:{click:function(e){return t.sendCmd("commit")}}},[t._v(" commit ")])],1),s("v-col",{attrs:{cols:"3"}},[s("v-btn",{staticClass:"white--text",attrs:{color:"indigo darken-1"},on:{click:function(e){return t.sendCmd("commit-hv")}}},[t._v(" commit-hv ")])],1),s("v-col",{attrs:{cols:"3"}},[s("v-btn",{staticClass:"white--text",attrs:{color:"indigo darken-1"},on:{click:function(e){return t.sendCmd("commit-sb")}}},[t._v(" commit-sb ")])],1),s("v-col",{attrs:{cols:"3"}},[s("v-btn",{staticClass:"white--text",attrs:{color:"indigo darken-1"},on:{click:function(e){return t.sendCmd("commit-ot")}}},[t._v(" commit-ot ")])],1)],1),s("v-row",{staticClass:"cmdRow",attrs:{dense:""}},[s("v-col",{attrs:{cols:"3"}},[s("v-btn",{staticClass:"white--text",attrs:{color:"indigo darken-1"},on:{click:function(e){return t.sendCmd("load-default-D")}}},[t._v(" load-default-D ")])],1),s("v-col",{attrs:{cols:"3"}},[s("v-btn",{staticClass:"white--text",attrs:{color:"indigo darken-1"},on:{click:function(e){return t.sendCmd("load-default-H")}}},[t._v(" load-default-H ")])],1),s("v-col",{attrs:{cols:"3"}},[s("v-btn",{staticClass:"white--text",attrs:{color:"indigo darken-1"},on:{click:function(e){return t.sendCmd("store-default-D")}}},[t._v(" store-default-D ")])],1),s("v-col",{attrs:{cols:"3"}},[s("v-btn",{staticClass:"white--text",attrs:{color:"indigo darken-1"},on:{click:function(e){return t.sendCmd("store-default-H")}}},[t._v(" store-default-H ")])],1)],1),s("v-row",{staticClass:"cmdRow",attrs:{dense:""}},[s("v-col",{attrs:{cols:"4"}},[s("v-btn",{staticClass:"white--text",attrs:{color:"indigo darken-1"},on:{click:function(e){return t.sendCmd("load-sfh")}}},[t._v(" load-sfh ")])],1),s("v-col",{attrs:{cols:"3"}},[s("v-text-field",{staticClass:"d-inline",attrs:{label:"Shot Number",type:"number"},model:{value:t.shotNum,callback:function(e){t.shotNum=e},expression:"shotNum"}})],1),s("v-col",{attrs:{cols:"3"}},[s("v-btn",{staticClass:"d-inline white--text",attrs:{color:"indigo darken-1"},on:{click:function(e){return t.sendCmd("load-sfh-"+t.shotNum)}}},[t._v(" load-sfh-"+t._s(t.shotNum)+" ")])],1)],1)],1),s("v-card-actions",[s("v-spacer"),s("v-btn",{attrs:{flex:"",color:"indigo darken-1",text:""},on:{click:function(e){t.dialog=!1}}},[t._v("Close")])],1)],1)],1)],1)},bt=[],pt={name:"Commands",data:function(){return{dialog:!1,tab:null,shotNum:2e3,wlNum:60.4}},methods:{sendCmd:function(t){"load-sfh-"==t&&(t="load-sfh");var e="codac/das/diag/msx/config/command",s=(new Date).getTime(),i={value:t,time:s};this.$mqtt.publish(e,JSON.stringify(i),{retain:!1})}},computed:{response:function(){return this.$store.getters.command},alertType:function(){return"ok"==this.response?"success":"warning"}}},gt=pt,_t=(s("5dbf"),Object(v["a"])(gt,ht,bt,!1,null,null,null)),Tt=_t.exports;b()(_t,{VAlert:L["a"],VBtn:lt["a"],VCard:j["a"],VCardActions:q["a"],VCol:G["a"],VContainer:J["a"],VDialog:vt["a"],VIcon:x["a"],VRow:X["a"],VSpacer:ut["a"],VTab:Z["a"],VTabs:et["a"],VTextField:nt["a"]});var xt={name:"switchboard",components:{SwitchboardPosition:mt,Commands:Tt},computed:{connecting:function(){return!this.$store.getters.connected}}},yt=xt,Ct=s("8e36"),wt=Object(v["a"])(yt,I,F,!1,null,null,null),Vt=wt.exports;b()(wt,{VCard:j["a"],VCardText:q["c"],VCol:G["a"],VContainer:J["a"],VDialog:vt["a"],VProgressLinear:Ct["a"],VRow:X["a"]});var Pt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"grey"},[t.connecting?t._e():s("div",[s("div",{staticClass:"statusdisplay"},[s("v-card",[s("h4",[t._v(" MSX running:"+t._s(t.status.msxrunning.state)+" "),s("v-icon",{class:t.status.msxrunning.colorClass},[t._v(" "+t._s(t.status.msxrunning.icon)+" ")])],1),s("h4",[t._v(" MSR running:"+t._s(t.status.msrrunning.state)+" "),s("v-icon",{class:t.status.msrrunning.colorClass},[t._v(" "+t._s(t.status.msrrunning.icon)+" ")])],1),s("h4",[t._v(" MSS running:"+t._s(t.status.mssrunning.state)+" "),s("v-icon",{class:t.status.mssrunning.colorClass},[t._v(" "+t._s(t.status.mssrunning.icon)+" ")])],1)])],1)]),s("v-dialog",{attrs:{"hide-overlay":"",persistent:"",width:"300"},model:{value:t.connecting,callback:function(e){t.connecting=e},expression:"connecting"}},[s("v-card",{attrs:{color:"primary",dark:""}},[s("v-card-text",[t._v(" Attempting to connect to broker "),s("v-progress-linear",{staticClass:"mb-0",attrs:{indeterminate:"",color:"white"}})],1)],1)],1)],1)},kt=[],St={name:"Status",computed:{status:function(){var t,e,s,i,n,a,r=this.$store.getters.status,o="",c="";return"OK"==r.msxrunning?(t="green--text",e="mdi-check-circle"):"OFF"==r.msxrunning?(t="grey--text",e="mdi-block-helper"):(t="red--text",e="mdi-help-circle",o="<<UNRECOGNISED STATUS VALUE>>"),"OK"==r.msrrunning?(s="green--text",i="mdi-check-circle"):"OFF"==r.msrrunning?(s="grey--text",i="mdi-block-helper"):"ERROR"==r.mssrunning?(s="red--text",i="mdi-alert"):(s="red--text",i="mdi-help-circle",c="<<UNRECOGNISED STATUS VALUE>>"),"OFF"==r.mssrunning?(n="grey--text",a="mdi-block-helper"):"ERROR"==r.mssrunning?(n="red--text",a="mdi-alert"):(n="green--text",a="mdi-check-circle"),{msxrunning:{state:r.msxrunning+o,colorClass:t,icon:e},msrrunning:{state:r.msrrunning+c,colorClass:s,icon:i},mssrunning:{state:r.mssrunning,colorClass:n,icon:a}}},connecting:function(){return!this.$store.getters.connected}}},Nt=St,$t=(s("4e5b"),Object(v["a"])(Nt,Pt,kt,!1,null,null,null)),Ot=$t.exports;b()($t,{VCard:j["a"],VCardText:q["c"],VDialog:vt["a"],VIcon:x["a"],VProgressLinear:Ct["a"]}),i["a"].use(E["a"]);var Mt=[{path:"/",name:"Switchboard",component:Vt},{path:"/status",name:"Status",component:Ot}],Et=new E["a"]({routes:Mt}),It=Et,Ft=s("f309");i["a"].use(Ft["a"]);for(var Yt=new Ft["a"]({}),Ht=s("2f62"),Dt=s("d4ec"),Rt=function t(){Object(Dt["a"])(this,t),this.fiberType="",this.fiberName=""},At=[],Bt=0;Bt<10;Bt++){for(var Lt=[],jt=0;jt<6;jt++)Lt.push(new Rt);At.push(Lt)}for(var qt={},Gt=1;Gt<11;Gt++){var Jt=("0"+Gt).slice(-2),Wt="PMT_"+Jt;qt[Wt]={tcrn:"",tset:"",heat_on:"",state:"",hvsource:"",fitM:"",fitC:"",wltarget:""}}for(var Ut=1;Ut<5;Ut++)for(var Kt=0;Kt<4;Kt++){var Xt=("0"+Ut).slice(-2),zt=void 0;0==Kt?zt="PI":1==Kt?zt="SIGMA":2==Kt?zt="BG1":3==Kt&&(zt="BG2");var Qt="PY_"+Xt+"_"+zt;qt[Qt]={tcrn:"",heat_on:"",state:"",hvsource:"",fitM:"",fitC:"",wltarget:""}}for(var Zt={},te=0;te<10;te++){var ee="HV_";ee+=String(2*te+1),ee+="_",ee+=String(2*te+2),Zt[ee+":0"]={value:"",oven:""},Zt[ee+":1"]={value:"",oven:""}}var se={connected:!1,msxrunning:"",msrrunning:"",mssrunning:""},ie={status:se,board:At,feed:Zt,ovens:qt,command:""},ne={connected:function(t){return t.status.connected},command:function(t){return t.command},status:function(t){return t.status},ovens:function(t){return t.ovens},feed:function(t){return t.feed},getFeedChannel:function(t){return function(e){if(e){var s=e.split("_"),i=s[1],n=s[2].split(":")[1],a=parseInt(i)-1+parseInt(n);return t.feed[a]}return"N/A"}},getBoardPosition:function(t){return function(e){return t.board[e.x][e.y]}}},ae={setCommand:function(t,e){t.commit("setCommand",e)},setConnected:function(t,e){t.commit("setConnected",e)},setfiberType:function(t,e){var s=e.x,i=e.y,n=e.value;t.commit("setfiberType",{x:s,y:i,value:n})},setfiberName:function(t,e){var s=e.x,i=e.y,n=e.value;t.commit("setfiberName",{x:s,y:i,value:n})},setFeedValue:function(t,e){var s=e.index,i=e.value;t.commit("setFeedValue",{index:s,value:i})},setHVValue:function(t,e){var s=e.x,i=e.y,n=e.value;t.commit("setHVValue",{x:s,y:i,value:n})},setOvenTcrn:function(t,e){var s=e.fiberType,i=e.value;t.commit("setOvenTcrn",{fiberType:s,value:i})},setOvenTset:function(t,e){var s=e.oven,i=e.value;t.commit("setOvenTset",{oven:s,value:i})},setOvenHeat_on:function(t,e){var s=e.fiberType,i=e.value;t.commit("setOvenHeat_on",{fiberType:s,value:i})},setOvenState:function(t,e){var s=e.oven,i=e.value;t.commit("setOvenState",{oven:s,value:i})},setStatus:function(t,e){var s=e.diagnostic,i=e.value;t.commit("setStatus",{diagnostic:s,value:i})},setDetectorHVPair:function(t,e){var s=e.hvsource,i=e.detector;t.commit("setDetectorHVPair",{hvsource:s,detector:i})},setOvenFitM:function(t,e){var s=e.oven,i=e.value;t.commit("setOvenFitM",{oven:s,value:i})},setOvenFitC:function(t,e){var s=e.oven,i=e.value;t.commit("setOvenFitC",{oven:s,value:i})},setWLTarget:function(t,e){var s=e.oven,i=e.value;t.commit("setWLTarget",{oven:s,value:i})}},re={setCommand:function(t,e){t.command=e},setConnected:function(t,e){t.status.connected=e},setfiberType:function(t,e){var s=e.x,i=e.y,n=e.value;t.board[s][i].fiberType=n},setfiberName:function(t,e){var s=e.x,i=e.y,n=e.value;t.board[s][i].fiberName=n},setFeedValue:function(t,e){var s=e.index,n=e.value;i["a"].set(t.feed,s,{value:n,oven:t.feed.oven})},setHVValue:function(t,e){var s=e.x,i=e.y,n=e.value;t.board[s][i].PMT.hvlabel=n,t.board[s][i].PY.pi.hvlabel=n},setOvenTcrn:function(t,e){var s=e.fiberType,i=e.value;t.ovens[s].tcrn=i},setOvenTset:function(t,e){var s=e.oven,i=e.value;t.ovens[s].tset=i},setOvenHeat_on:function(t,e){var s=e.fiberType,i=e.value;t.ovens[s].heat_on=i},setOvenState:function(t,e){var s=e.oven,i=e.value;i=1==parseInt(i),t.ovens[s].state=i},setStatus:function(t,e){var s=e.diagnostic,i=e.value;t.status[s]=i},setDetectorHVPair:function(t,e){var s=e.hvsource,i=e.detector,n=ie.feed[s].oven;if("n/a"!=n&&n&&(ie.ovens[ie.feed[s].oven].hvsource=""),"n/a"!=i&&i){var a=ie.ovens[i].hvsource;"n/a"!=a&&a&&(ie.feed[a].oven="")}ie.feed[s].oven=i,"n/a"!=i&&(ie.ovens[i].hvsource=s)},setOvenFitM:function(t,e){var s=e.oven,i=e.value;t.ovens[s].fitM=i},setOvenFitC:function(t,e){var s=e.oven,i=e.value;t.ovens[s].fitC=i},setWLTarget:function(t,e){var s=e.oven,i=e.value;console.log(s,i),t.ovens[s].wltarget=i}},oe={state:ie,getters:ne,actions:ae,mutations:re};i["a"].use(Ht["a"]);var ce=new Ht["a"].Store({modules:{data:oe}}),le={clientId:"WebClient-"+parseInt(1e5*Math.random()),username:"joneill",password:"123456"};i["a"].use(M.a,"ws://lxrem.aug.ipp.mpg.de:1884",le),i["a"].use(Yt),i["a"].config.productionTip=!1,new i["a"]({el:"#app",template:"<App/>",router:It,vuetify:Yt,store:ce,components:{App:$}})},"5dbf":function(t,e,s){"use strict";var i=s("630b"),n=s.n(i);n.a},"630b":function(t,e,s){},"8a23":function(t,e,s){},c3d2:function(t,e,s){"use strict";var i=s("4310"),n=s.n(i);n.a}});
//# sourceMappingURL=app.53f3e276.js.map